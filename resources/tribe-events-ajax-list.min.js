(function(b,d,h,e,a,f,m){b(document).ready(function(){function l(b){"change_view"!=tribe_events_bar_action&&(b.preventDefault(),a.ajax_running||(a.paged=1,a.view="list",a.popping=!1,e.pre_ajax(function(){k()})))}function k(){b("#tribe-events-header").tribe_spin();a.ajax_running=!0;if(!a.popping){a.filter_cats&&(d.cur_url=b("#tribe-events-header").attr("data-baseurl"));var c=b("#tribe-events-list-hash").val();a.params={action:"tribe_list",tribe_paged:a.paged,tribe_event_display:a.view};a.url_params=
{action:"tribe_list",tribe_paged:a.paged};c.length&&(a.params.hash=c);a.category&&(a.params.tribe_event_category=a.category);b(h).trigger("tribe_ev_serializeBar");a.params=b.param(a.params);a.url_params=b.param(a.url_params);b(h).trigger("tribe_ev_collectParams");a.pushstate=!1;a.do_string=!0}f.pushstate&&!a.filter_cats?(b(h).trigger("tribe_ev_ajaxStart").trigger("tribe_ev_listView_AjaxStart"),b.post(TribeList.ajaxurl,a.params,function(c){a.initial_load=!1;e.enable_inputs("#tribe_events_filters_form",
"input, select");c.success&&(a.ajax_running=!1,d.ajax_response={total_count:parseInt(c.total_count),view:c.view,max_pages:c.max_pages,tribe_paged:c.tribe_paged,timestamp:(new Date).getTime()},b("#tribe-events-list-hash").val(c.hash),b("#tribe-events-content").replaceWith(c.html),b("#tribe-events-content").next(".tribe-clear").remove(),0===c.total_count&&b("#tribe-events-header .tribe-events-sub-nav").empty(),a.do_string&&history.pushState({tribe_params:a.params,tribe_url_params:a.url_params},"",d.cur_url+
"?"+a.url_params),a.pushstate&&history.pushState({tribe_params:a.params,tribe_url_params:a.url_params},"",d.cur_url),b(h).trigger("tribe_ev_ajaxSuccess").trigger("tribe_ev_listView_AjaxSuccess"))})):window.location=a.do_string?d.cur_url+"?"+a.url_params:d.cur_url}var g=e.get_url_param("tribe_paged");g&&(a.paged=g);f.pushstate&&!f.map_view()&&(g="action=tribe_list&tribe_paged="+a.paged,d.params.length&&(g=g+"&"+d.params),history.replaceState({tribe_params:g,tribe_url_params:d.params},"",location.href),
b(window).on("popstate",function(b){if(b=b.originalEvent.state)a.do_string=!1,a.pushstate=!1,a.popping=!0,a.params=b.tribe_params,a.url_params=b.tribe_url_params,e.pre_ajax(function(){k()}),e.set_form(a.params)}));b("#tribe-events-content-wrapper").on("click","li.tribe-events-nav-next a",function(c){c.preventDefault();a.ajax_running||(b(this).parent().is(".tribe-events-past")?a.view="past":a.view="list",d.cur_url=e.url_path(b(this).attr("href")),a.paged++,a.popping=!1,e.pre_ajax(function(){k()}))}).on("click",
"li.tribe-events-nav-previous a",function(c){c.preventDefault();a.ajax_running||(b(this).parent().is(".tribe-events-past")?a.view="past":a.view="list",d.cur_url=e.url_path(b(this).attr("href")),1<a.paged&&a.paged--,a.popping=!1,e.pre_ajax(function(){k()}))});e.snap("#tribe-events-content-wrapper","#tribe-events-content-wrapper","#tribe-events-footer .tribe-events-nav-previous a, #tribe-events-footer .tribe-events-nav-next a");if(f.live_ajax()&&f.pushstate)b("#tribe-events-bar").on("changeDate","#tribe-bar-date",
function(b){f.reset_on()||(a.popping=!1,l(b))});b("form#tribe-bar-form").on("submit",function(b){a.popping=!1;l(b)});b(h).on("tribe_ev_runAjax",function(){k()});m&&debug.info("tribe-events-ajax-list.js successfully loaded")})})(jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
