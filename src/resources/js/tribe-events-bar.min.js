var tribe_events_bar_action;!function(p,m,u,_,g,f,h,w,k){u(m).ready(function(){k&&(u().bootstrapDatepicker||tec_debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-events-bar.js"),u().placeholder||tec_debug.warn("TEC Debug: vendor placeholder was not loaded before its dependant file tribe-events-bar.js"));var e=u(m.getElementById("tribe-bar-form")),r=u(m.getElementById("tribe-bar-date")),t=(u(m.getElementById("tribe-events")),u(m.getElementById("tribe-events-header"))),a=0,i=u("select[name=tribe-bar-view]");function n(e){if(!e.parents(".tribe-bar-disabled").length){var t=e.width();800<t?e.removeClass("tribe-bar-mini tribe-bar-collapse").addClass("tribe-bar-full"):e.removeClass("tribe-bar-full").addClass("tribe-bar-mini"),t<728?e.removeClass("tribe-bar-mini").addClass("tribe-bar-collapse"):e.removeClass("tribe-bar-collapse")}}if(t.length&&(a=t.data("startofweek")),n(e),e.resize(function(){n(e)}),!u(".tribe-events-week-grid").length&&"month"!==h.view){var s="yyyy-mm-dd";if("0"!==h.datepicker_format){s=_.datepicker_formats.main[h.datepicker_format];var b=f.get_url_param("tribe-bar-date");b?r.val(tribeDateFormat(b,h.datepicker_format)):"day"===h.view&&0!==r.val().length&&r.val(tribeDateFormat(r.val(),h.datepicker_format))}k&&tec_debug.info('TEC Debug: bootstrapDatepicker was just initialized in "tribe-events-bar.js" on:',r),_.datepicker_opts={weekStart:a,format:s,autoclose:!0},r.bootstrapDatepicker(_.datepicker_opts)}r.blur(function(){""===r.val()&&u(".datepicker.dropdown-menu").is(":hidden")&&w.live_ajax()&&w.pushstate&&(h.date=_.cur_date,_.cur_url=_.base_url,u(g).trigger("tribe_ev_runAjax"),u(g).trigger("run-ajax.tribe"))}),u(".tribe-bar-settings").length&&u(m.getElementById("tribe-events-bar")).addClass("tribe-has-settings"),u("#tribe-events-bar .hasDatepicker").length&&u(m.getElementById("tribe-events-bar")).addClass("tribe-has-datepicker"),u('input[name*="tribe-bar-"]').placeholder(),u('<ul class="tribe-bar-views-list" />').insertAfter(i);var l=u(".tribe-bar-views-list");i.find("option").each(function(e){var t=u(this);displaying=t.data("view");var a="tribe-bar-views-option-"+t.data("view");u("<li></li>",{class:"tribe-bar-views-option "+a,"data-tribe-bar-order":e,"data-view":displaying}).html(['   <a href="#">','   <span class="tribe-icon-'+displaying+'">'+t.text()+"</span>","</a>"].join("")).appendTo(".tribe-bar-views-list")});var o=i.find(":selected").data("view");function d(){if(tribe_events_bar_action="change_view","month"===h.view&&r.length){var e=r.val(),t=f.get_day();"0"!=h.datepicker_format?(e=tribeDateFormat(r.bootstrapDatepicker("getDate"),"tribeMonthQuery"),r.val(e+t)):7===e.length&&r.val(e+t)}h.url_params={},u(g).trigger("tribe_ev_preCollectBarParams"),u(g).trigger("pre-collect-bar-params.tribe"),u(m.getElementById("tribe-bar-form")).add(m.getElementById("tribe_events_filters_wrapper")).find("input, select").each(function(){var e=u(this);e.val()&&e.val().length&&!e.hasClass("tribe-no-param")&&("month"!==h.view&&"0"!==h.datepicker_format&&e.is(r)?h.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"):e.is(":checkbox")?e.is(":checked")&&(void 0===h.url_params[e.attr("name")]&&(h.url_params[e.attr("name")]=[]),h.url_params[e.attr("name")].push(e.val())):"radio"===e.attr("type")?e.is(":checked")&&(h.url_params[e.attr("name")]=e.val()):void 0!==e.attr("name")&&(h.url_params[e.attr("name")]=e.val()))});var a=u(".tribe-bar-views-option-"+_.default_mobile_view).data("redirected");(_.redirected_view||a)&&(h.url_params.tribe_redirected=!0),h.url_params=u.param(h.url_params),u(g).trigger("tribe_ev_postCollectBarParams"),u(g).trigger("post-collect-bar-params.tribe"),h.url_params.length&&(h.cur_url+=w.starting_delim()+h.url_params),p.location.href=h.cur_url}l.find("li[data-view="+o+"]").prependTo(l).addClass("tribe-bar-active"),i.hide(),e.on("click","#tribe-bar-views",function(e){e.stopPropagation(),u(this).toggleClass("tribe-bar-views-open")}),e.on("click",".tribe-bar-views-option",function(e){e.preventDefault();var t=u(this);if(!t.is(".tribe-bar-active")){var a=t.data("view");h.cur_url=u("option[data-view="+a+"]").val(),h.view_target=u('select[name=tribe-bar-view] option[value="'+h.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",d()}}),f.maybe_default_view_change(),e.on("change",".tribe-bar-views-select",function(e){e.preventDefault();var t=u("option:selected",this).data("view");h.cur_url=u("option[data-view="+t+"]").val(),h.view_target=u('select[name=tribe-bar-view] option[value="'+h.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",d()}),e.on("click","#tribe-bar-collapse-toggle",function(){u(this).toggleClass("tribe-bar-filters-open"),u(".tribe-bar-filters").slideToggle("fast")}),u('label[for="tribe-bar-date"], input[name="tribe-bar-date"]').wrapAll('<div id="tribe-bar-dates" />'),u(m.getElementById("tribe-bar-filters")).before(u(m.getElementById("tribe-bar-dates"))),u(g).on("tribe_ev_serializeBar",function(){u("form#tribe-bar-form input, form#tribe-bar-form select, #tribeHideRecurrence").each(function(){var e=u(this);if(e.is("#tribe-bar-date")){var t=e.val();t.length?"month"===h.view?(h.params[e.attr("name")]=tribeDateFormat(h.mdate,"tribeMonthQuery"),h.url_params[e.attr("name")]=tribeDateFormat(h.mdate,"tribeMonthQuery")):t.match(/[0-9]{4}-[0-9]{2}/)?h.params[e.attr("name")]=h.url_params[e.attr("name")]=t:(h.params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery"),h.url_params[e.attr("name")]=tribeDateFormat(e.bootstrapDatepicker("getDate"),"tribeQuery")):e.is(".placeholder")&&e.is(".bd-updated")?h.url_params[e.attr("name")]=e.attr("data-oldDate"):h.date=_.cur_date}!e.val().length||e.hasClass("tribe-no-param")||e.is("#tribe-bar-date")||(e.is(":checkbox")?e.is(":checked")&&(h.params[e.attr("name")]=e.val(),"map"!==h.view&&(h.url_params[e.attr("name")]=e.val()),("month"===h.view||"day"===h.view||"week"===h.view||h.recurrence)&&h.pushcount++):(h.params[e.attr("name")]=e.val(),"map"!==h.view&&(h.url_params[e.attr("name")]=e.val()),"month"!==h.view&&"day"!==h.view&&"week"!==h.view||h.pushcount++))})});var v=u('#tribe-events-bar [class^="tribe-bar-button-"]'),c=v.next(".tribe-bar-drop-content");v.click(function(){var e=u(this);return e.toggleClass("open"),e.next(".tribe-bar-drop-content").toggle(),!1}),u(m).click(function(){u(m.getElementById("tribe-bar-views")).removeClass("tribe-bar-views-open"),v.hasClass("open")&&(v.removeClass("open"),c.hide())}),c.click(function(e){e.stopPropagation()}),k&&tec_debug.info("TEC Debug: tribe-events-bar.js successfully loaded")})}(window,document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);